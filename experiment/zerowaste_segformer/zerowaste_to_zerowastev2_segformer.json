{"log_config": {"interval": 50, "hooks": [{"type": "TextLoggerHook", "by_epoch": false}]}, "dist_params": {"backend": "nccl"}, "log_level": "INFO", "load_from": null, "resume_from": null, "workflow": [["train", 1]], "cudnn_benchmark": true, "norm_cfg": {"type": "BN", "requires_grad": true}, "find_unused_parameters": true, "model": {"type": "EncoderDecoder", "pretrained": "pretrained/mit_b5.pth", "backbone": {"type": "mit_b5", "style": "pytorch"}, "decode_head": {"type": "SegFormerHead", "in_channels": [64, 128, 320, 512], "in_index": [0, 1, 2, 3], "channels": 128, "dropout_ratio": 0.1, "num_classes": 19, "norm_cfg": {"type": "BN", "requires_grad": true}, "align_corners": false, "decoder_params": {"embed_dim": 768, "conv_kernel_size": 1}, "loss_decode": {"type": "CrossEntropyLoss", "use_sigmoid": false, "loss_weight": 1.0}}, "train_cfg": {"work_dir": "/data/home/jkataok1/AVATAR2022/experiment/zerowaste_segformer"}, "test_cfg": {"mode": "whole"}}, "dataset_type": "ZeroWasteDataset", "data_root": "data/zerowaste-v2-splits/", "img_norm_cfg": {"mean": [123.675, 116.28, 103.53], "std": [58.395, 57.12, 57.375], "to_rgb": true}, "crop_size": [512, 512], "train_pipeline": [{"type": "LoadImageFromFile"}, {"type": "LoadAnnotations"}, {"type": "Resize", "img_scale": [1280, 720]}, {"type": "RandomCrop", "crop_size": [512, 512], "cat_max_ratio": 0.75}, {"type": "RandomFlip", "prob": 0.5}, {"type": "PhotoMetricDistortion"}, {"type": "Normalize", "mean": [123.675, 116.28, 103.53], "std": [58.395, 57.12, 57.375], "to_rgb": true}, {"type": "Pad", "size": [512, 512], "pad_val": 0, "seg_pad_val": 255}, {"type": "DefaultFormatBundle"}, {"type": "Collect", "keys": ["img", "gt_semantic_seg"]}], "test_pipeline": [{"type": "LoadImageFromFile"}, {"type": "MultiScaleFlipAug", "img_scale": [1024, 512], "flip": false, "transforms": [{"type": "Resize", "keep_ratio": true}, {"type": "RandomFlip"}, {"type": "Normalize", "mean": [123.675, 116.28, 103.53], "std": [58.395, 57.12, 57.375], "to_rgb": true}, {"type": "ImageToTensor", "keys": ["img"]}, {"type": "Collect", "keys": ["img"]}]}], "data": {"samples_per_gpu": 2, "workers_per_gpu": 4, "train": {"type": "ZeroWasteDataset", "data_root": "data/zerowaste-f/train", "img_dir": "data", "ann_dir": "sem_seg", "pipeline": [{"type": "LoadImageFromFile"}, {"type": "LoadAnnotations"}, {"type": "Resize", "img_scale": [1280, 720]}, {"type": "RandomCrop", "crop_size": [512, 512], "cat_max_ratio": 0.75}, {"type": "RandomFlip", "prob": 0.5}, {"type": "PhotoMetricDistortion"}, {"type": "Normalize", "mean": [123.675, 116.28, 103.53], "std": [58.395, 57.12, 57.375], "to_rgb": true}, {"type": "Pad", "size": [512, 512], "pad_val": 0, "seg_pad_val": 255}, {"type": "DefaultFormatBundle"}, {"type": "Collect", "keys": ["img", "gt_semantic_seg"]}]}, "val": {"type": "ZeroWasteDataset", "data_root": "data/zerowaste-f/test", "img_dir": "data", "ann_dir": "sem_seg", "pipeline": [{"type": "LoadImageFromFile"}, {"type": "MultiScaleFlipAug", "img_scale": [1024, 512], "flip": false, "transforms": [{"type": "Resize", "keep_ratio": true}, {"type": "RandomFlip"}, {"type": "Normalize", "mean": [123.675, 116.28, 103.53], "std": [58.395, 57.12, 57.375], "to_rgb": true}, {"type": "ImageToTensor", "keys": ["img"]}, {"type": "Collect", "keys": ["img"]}]}]}, "test": {"type": "ZeroWasteV2Dataset", "data_root": "data/zerowaste-v2-splits/test", "img_dir": "data", "ann_dir": "sem_seg", "pipeline": [{"type": "LoadImageFromFile"}, {"type": "MultiScaleFlipAug", "img_scale": [1024, 512], "flip": false, "transforms": [{"type": "Resize", "keep_ratio": true}, {"type": "RandomFlip"}, {"type": "Normalize", "mean": [123.675, 116.28, 103.53], "std": [58.395, 57.12, 57.375], "to_rgb": true}, {"type": "ImageToTensor", "keys": ["img"]}, {"type": "Collect", "keys": ["img"]}]}]}}, "optimizer": {"type": "AdamW", "lr": 6e-05, "betas": [0.9, 0.999], "weight_decay": 0.01, "paramwise_cfg": {"custom_keys": {"head": {"lr_mult": 10.0}, "pos_block": {"decay_mult": 0.0}, "norm": {"decay_mult": 0.0}}}}, "optimizer_config": {}, "lr_config": {"policy": "poly", "warmup": "linear", "warmup_iters": 1500, "warmup_ratio": 1e-06, "power": 1.0, "min_lr": 0.0, "by_epoch": false}, "n_gpus": 1, "seed": 0, "runner": {"type": "IterBasedRunner", "max_iters": 40000}, "checkpoint_config": {"by_epoch": false, "interval": 8000, "max_keep_ckpts": 1}, "evaluation": {"interval": 5000, "metric": "mIoU"}, "name": "zerowaste2zerowastev2_source-only_segformer_mitb5", "exp": 1, "name_dataset": "zerowaste2zerowastev2", "name_architecture": "segformer_mitb5", "name_encoder": "mitb5", "name_decoder": "segformer", "name_uda": "source-only", "name_opt": "adamw_6e-05_pmTrue_poly10warm_1x2_40k", "work_dir": "/data/home/jkataok1/AVATAR2022/experiment/zerowaste_segformer", "git_rev": "8d6e710700ff5e6a053c77bfe384ba44d4672cbe", "gpu_ids": [0]}